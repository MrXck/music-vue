<template>    <div class="song-list">        <n-layout has-sider>            <n-scrollbar style="height: calc(100vh - 56px - 80px - 24px)">                <div v-if="isLoading">                    <n-spin size="large"/>                </div>                <div v-else class="list">                    <n-image                        width="240"                        :src="song_list.imgSrc"                        height="240"                    />                    <div class="song-list-detail">                        <div class="title">                            <n-tag type="success">                                歌单                            </n-tag>                            <span class="song-list-name">{{ song_list.name }}</span>                        </div>                        <div class="author">                            <n-image                                width="24"                                :src="song_list.user.avatar"                            />                            <span class="author-name">{{ song_list.user.username }}</span>                            <span class="create-time">{{ song_list.createTime.split('T')[0] }}创建</span>                        </div>                        <div class="option">                            <n-space>                                <n-button @click="playAll" round size="medium" type="primary">                                    <n-icon>                                        <svg xmlns="http://www.w3.org/2000/svg"                                             xmlns:xlink="http://www.w3.org/1999/xlink"                                             viewBox="0 0 512 512">                                            <path                                                d="M133 440a35.37 35.37 0 0 1-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0 1 35.77.45l247.85 148.36a36 36 0 0 1 0 61l-247.89 148.4A35.5 35.5 0 0 1 133 440z"                                                fill="currentColor"></path>                                        </svg>                                    </n-icon>                                    播放全部                                </n-button>                                <n-button v-if="!song_list.isCollect" @click="collectSongList" round size="medium">                                    <n-icon>                                        <svg xmlns="http://www.w3.org/2000/svg"                                             xmlns:xlink="http://www.w3.org/1999/xlink"                                             viewBox="0 0 512 512">                                            <path                                                d="M480 208H308L256 48l-52 160H32l140 96l-54 160l138-100l138 100l-54-160z"                                                fill="none" stroke="currentColor" stroke-linejoin="round"                                                stroke-width="32"></path>                                        </svg>                                    </n-icon>                                    收藏                                </n-button>                                <n-button v-else @click="notCollectSongList" round size="medium">                                    <n-icon color="#18a058">                                        <svg xmlns="http://www.w3.org/2000/svg"                                             xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512">                                            <path                                                d="M394 480a16 16 0 0 1-9.39-3L256 383.76L127.39 477a16 16 0 0 1-24.55-18.08L153 310.35L23 221.2a16 16 0 0 1 9-29.2h160.38l48.4-148.95a16 16 0 0 1 30.44 0l48.4 149H480a16 16 0 0 1 9.05 29.2L359 310.35l50.13 148.53A16 16 0 0 1 394 480z"                                                fill="currentColor"></path>                                        </svg>                                    </n-icon>                                    已收藏                                </n-button>                                <n-button @click="copyToClipboard" round size="medium">                                    <n-icon>                                        <svg xmlns="http://www.w3.org/2000/svg"                                             xmlns:xlink="http://www.w3.org/1999/xlink"                                             viewBox="0 0 512 512">                                            <circle cx="128" cy="256" r="48" fill="none" stroke="currentColor"                                                    stroke-linecap="round" stroke-linejoin="round"                                                    stroke-width="32"></circle>                                            <circle cx="384" cy="112" r="48" fill="none" stroke="currentColor"                                                    stroke-linecap="round" stroke-linejoin="round"                                                    stroke-width="32"></circle>                                            <circle cx="384" cy="400" r="48" fill="none" stroke="currentColor"                                                    stroke-linecap="round" stroke-linejoin="round"                                                    stroke-width="32"></circle>                                            <path fill="none" stroke="currentColor" stroke-linecap="round"                                                  stroke-linejoin="round" stroke-width="32"                                                  d="M169.83 279.53l172.34 96.94"></path>                                            <path fill="none" stroke="currentColor" stroke-linecap="round"                                                  stroke-linejoin="round" stroke-width="32"                                                  d="M342.17 135.53l-172.34 96.94"></path>                                        </svg>                                    </n-icon>                                    分享                                </n-button>                            </n-space>                        </div>                        <div class="tag"><!--                            <span>标签:</span>-->                            <span>歌曲 : {{songs.length}}</span>                        </div>                    </div>                </div>                <div class="content">                    <n-space justify="end">                        <n-input                            type="text"                            show-password-on="mousedown"                            placeholder="搜索歌曲"                            :maxlength="8"                            round                            size="small"                            @update:value="search"                        >                            <template #prefix>                                <n-icon :component="Search"/>                            </template>                        </n-input>                    </n-space>                    <n-tabs default-value="song-list" type="line">                        <n-tab-pane name="song-list" tab="歌曲列表">                            <SongTable :songList="songList" @init="initSongList" :needSinger="true" />                        </n-tab-pane>                        <n-tab-pane name="the beatles" :tab="'评论 (' + songListComment.total + ')'"><!--                            <div v-if="isLoading">--><!--                                <n-spin size="large"/>--><!--                            </div>--><!--                            <div v-else>-->                            <div style="padding: 0 10px">                                <n-input @update:value="updateComment" type="textarea" maxlength="140" show-count placeholder="请输入"/>                                <n-space style="margin-top: 10px" justify="end">                                    <n-button @click="addComment" round size="medium">                                        评论                                    </n-button>                                </n-space>                            </div>                            <h3>精彩评论</h3>                            <Comment v-for="item in wonderfulComments" :comment="item" :starUrl="'/songListComment/star/'"/>                            <h3>最新评论</h3>                            <Comment v-for="item in songListComment.records" :comment="item" :starUrl="'/songListComment/star/'"/>                            <n-space justify="center">                                <n-pagination                                    v-if="songListComment.records.length > 0"                                    v-model:page="page"                                    v-model:page-size="pageSize"                                    @update:page="initComment"                                    @update:page-size="initComment"                                    :page-count="totalPage"                                    show-size-picker                                    :page-sizes="[10, 20, 30, 40]"                                />                            </n-space>                        </n-tab-pane>                    </n-tabs>                </div>            </n-scrollbar>        </n-layout>    </div></template><script>import {useRoute} from 'vue-router'import {computed, onMounted, reactive, ref} from 'vue'import {    NLayout,    NLayoutSider,    NImage,    NGi,    NGrid,    NTag,    NButton,    NIcon,    NSpace,    NTabs,    NTabPane,    NSpin,    NInput,    NPagination,    NScrollbar,    useMessage,} from 'naive-ui'import request from '../utils/request'import Comment from '../components/Comment'import {Search, HeartSharp} from '@vicons/ionicons5'import {usePlayStore} from '../store'import SongTable from '../components/SongTable'export default {    name: 'SongList',    components: {        SongTable,        Comment,        NLayout,        NLayoutSider,        NImage,        NGrid,        NGi,        NTag,        NButton,        NIcon,        NSpace,        NTabs,        NTabPane,        NSpin,        NInput,        NPagination,        NScrollbar,    },    setup(){        let route = useRoute()        let songs = reactive([])        let song_list = ref({})        let commentContent = ref('')        let isLoading = ref(true)        let page = ref(1)        let pageSize = ref(10)        let songListComment = ref({})        let wonderfulComments = ref([])        let totalPage = ref(0)        let searchKey = ref('')        let message = useMessage()        let playStore = usePlayStore()        let songList = computed(() => {            if (searchKey.value !== '') {                return songs.filter(item => {                    return item.name.indexOf(searchKey.value) !== -1                })            } else {                return songs            }        })        onMounted(() => {            init()            initComment()            request.get('/songListComment/getWonderfulSongListComment/' + route.params.id).then(res => {                if(res.data.code === 0){                    wonderfulComments.value = res.data.data                }            })        })        function init(){            request.get('/songList/' + route.params.id).then(res => {                if (res.data.code === 0) {                    songs.splice(0, songs.length)                    songs.push(...res.data.data.songs)                    for (let i = 0; i < songs.length; i++) {                        let second = Math.floor(songs[i].time % 60)                        if (second.toString().length < 2) {                            second = '0' + second                        }                        songs[i].time = Math.floor(songs[i].time / 60) + ':' + second                    }                    song_list.value = res.data.data                    isLoading.value = false                }            })        }        function initComment(){            request.get(`/songListComment/${route.params.id}?pageNum=${page.value}&pageSize=${pageSize.value}`).then(res => {                if (res.data.code === 0) {                    songListComment.value = res.data.data                    totalPage.value = res.data.data.pages                }            })        }        function addComment(){            request.post('/songListComment/addComment', {                songListId: route.params.id,                content: commentContent.value,            }).then(res => {                if (res.data.code === 0) {                    message.success(res.data.data)                } else {                    message.error(res.data.msg)                }            })        }        function updateComment(value){            commentContent.value = value        }        function playAll(){            playStore.play(songs, songs[0])        }        function copyToClipboard(){            message.success(location.href)        }        function search(value) {            searchKey.value = value        }        function collectSongList(){            request.get(`/songListCollect/addSongListCollect/${route.params.id}`).then(res => {                if(res.data.code === 0){                    message.success(res.data.data)                    song_list.value.isCollect = true                }else {                    message.error(res.data.msg)                }            })        }        function notCollectSongList(){            request.get(`/songListCollect/notSongListCollect/${route.params.id}`).then(res => {                if (res.data.code === 0) {                    message.success(res.data.data)                    song_list.value.isCollect = false                } else {                    message.error(res.data.msg)                }            })        }        function initSongList(){            init()        }        return {            songs,            song_list,            isLoading,            songListComment,            wonderfulComments,            page,            pageSize,            totalPage,            commentContent,            playStore,            searchKey,            songList,            initComment,            addComment,            updateComment,            playAll,            copyToClipboard,            search,            collectSongList,            notCollectSongList,            initSongList,            Search,            HeartSharp,        }    }}</script><style scoped>.song-list{    padding-left: 24px;    padding-top: 24px;    padding-right: 24px;}.song-list-detail{    display: flex;    padding-left: 36px;    flex-direction: column;}.song-list-detail .title{    display: flex;    align-items: center;}.list{    display: flex;}.author{    display: flex;    align-items: center;    padding-top: 10px;}.author .author-name{    padding: 0 10px;    color: #0ea5e9;}.n-image{    border-radius: 5px;}.option{    padding: 10px 0;}.tag{    display: flex;    flex-direction: column;}.song-list-name{    font-size: 24px;    font-weight: bold;    padding-left: 10px;}.content{    padding-top: 20px;}.author .n-image{    border-radius: 50%;}.n-pagination {    margin: 10px 0;}</style>