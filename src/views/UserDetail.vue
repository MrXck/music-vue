<template><div class="user-detail-edit">    <h2>编辑个人信息</h2>    <n-space>        <n-space vertical>            <n-space align="center">                昵称：                <n-input v-model:value="userDetail.username" type="text" placeholder="用户名"/>            </n-space>            <n-space align="center">                密码：                <n-input v-model:value="userDetail.password" type="password" placeholder="不输入为不修改"/>            </n-space>            <n-space size="large" item-style="padding-top: 20px; padding-left: 30px">                <n-button @click="updateUserDetail" type="success">保存</n-button>                <n-button>取消</n-button>            </n-space>        </n-space>        <n-space vertical align="center">            <n-avatar :size="200" :src="userDetail.avatar" :fallback-src="notImage"></n-avatar>            <n-button @click="chooseImg">修改头像</n-button>            <input ref="file" type="file" class="hidden" @change="uploadImg">        </n-space>    </n-space></div></template><script>import notImage from '../assets/notImage.jpg'import {reactive, onMounted, getCurrentInstance} from 'vue'import {NSpace, NInput, NButton, NAvatar, useMessage} from 'naive-ui'import request from '../utils/request'export default {    name: 'UserDetail',    setup(){        let user = JSON.parse(localStorage.getItem('user'))        let userDetail = reactive({            username: user.username,            password: '',            avatar: user.avatar,        })        let file = null        let message = useMessage()        onMounted(() => {            file = getCurrentInstance().refs.file        })        function uploadImg(){            if (!(file.files[0].type === "image/png") && !(file.files[0].type === "image/jpeg")) {                message.error("只能上传png/jpeg格式的图片文件，请重新上传")                return false            }            if (!(file.files[0].size / 1024 / 1024 < 2)) {                message.error('上传头像图片大小不能超过 2MB!');                return false            }            const param = new FormData()            param.append('file', file.files[0])            request.post('/file/uploadAvatar', param, {headers: {"Content-Type": "multipart/form-data"}}).then(res => {                console.log(res.data)                if(res.data.code === 0){                    userDetail.avatar = res.data.data                }            })        }        function chooseImg(){            file.click()        }        function updateUserDetail(){            request.post('/user/update', userDetail).then(res => {                if(res.data.code === 0){                    message.success('修改成功')                    localStorage.setItem('user', JSON.stringify(res.data.data))                    location.reload()                }else {                    message.error('修改失败')                }            })        }        return {            userDetail,            notImage,            uploadImg,            chooseImg,            updateUserDetail,        }    },    components: {        NSpace,        NInput,        NButton,        NAvatar,    }}</script><style scoped>.user-detail-edit{    padding: 24px;}.hidden{    display: none;}</style>